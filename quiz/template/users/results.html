{% extends 'base.html' %}
{% block title %}Result detail{% endblock %}
{% block content %}
{% csrf_token %}
{% if user.is_authenticated %}
<div class="container text-center p-4 my-5  bg-info bg-gradient text-white rounded">
    <h1>Quiz Results</h1>
    {% if categories %}
    <form method="post">
        {% csrf_token %}
        <label for="category_select">Select a category:</label>
        <select id="category_select" name="category_id" class="mx-2 p-1 text-dark fw-bold px-5">
            <option value="">-- Select a category --</option>
            {% for category in categories %}
            <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-dark rounded-pill">Show Results</button>
    </form>
    {% else %}
    <div class="list-group list-group-flush text-center">
        <h1 class="list-group-item text-danger my-2 py-5">You have not done the test yet.</h1>
        <h3 class="text-dark my-2 pt-2">Get started today - what are you waiting for?</h3>
    </div>
    <a href="{% url 'HomeUser' %}">
        <button class="btn btn-primary btn-lg px-5 m-5 rounded-pill" title="Register">
            start
        </button>
    </a>
    {% endif %}

    {% if questions %}
    <h2>Category: {{ category_name }}</h2>
    <table class="table table-striped table-bodered">
        <thead>
            <tr>
                <th>Question</th>
                <th>Your Answer</th>
                <th>Correct Answer</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody>
            {% for question in questions %}
            <tr>
                <td>{{ question.question_text }}</td>
                {% if question.answer %}
                <td>{{ question.answer }}</td>
                <td>{{ question.correct_answer }}</td>
                {% else %}
                <td colspan="3">You did not answer this question.</td>
                {% endif %}
                <td>{{ question.score }}</td>
            </tr>
            {% endfor %}
            <tr>
                <td colspan="3"><strong>Total Score:</strong></td>
                <td>{{ total_score }}</td>
            </tr>
        </tbody>
    </table>
    {% endif %}
</div>
{% endif %}
{% endblock %}